<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Wee::Presenter</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Wee::Presenter</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/wee/template_rb.html">
                lib/wee/template.rb
                </a>
        <br />
                <a href="../../files/lib/wee/core/presenter_rb.html">
                lib/wee/core/presenter.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="Presenter.html">Wee::Presenter</a> is the superclass of all
classes that want to participate in rendering and callback-processing. <a
href="Component.html">Wee::Component</a> and <a
href="Decoration.html">Wee::Decoration</a> are it&#8217;s two most
important subclasses.
</p>

    </div>


    <div id="contents-list">
      <h3 class="section-bar">Contents</h3>
      <ul>
      <li><a href="#SEC00088">Render</a></li>
      <li><a href="#SEC00089">Callback</a></li>
      <li><a href="#SEC00090">Backtrack</a></li>
      <li><a href="#SEC00091">Session</a></li>
      <li><a href="#SEC00092">Properties</a></li>
     </ul>
   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000290">backtrack_state</a>&nbsp;&nbsp;
      <a href="#M000284">do_render</a>&nbsp;&nbsp;
      <a href="#M000292">get_property</a>&nbsp;&nbsp;
      <a href="#M000293">lookup_property</a>&nbsp;&nbsp;
      <a href="#M000289">process_callbacks</a>&nbsp;&nbsp;
      <a href="#M000286">r</a>&nbsp;&nbsp;
      <a href="#M000283">render</a>&nbsp;&nbsp;
      <a href="#M000285">renderer</a>&nbsp;&nbsp;
      <a href="#M000288">renderer_class</a>&nbsp;&nbsp;
      <a href="#M000291">session</a>&nbsp;&nbsp;
      <a href="#M000282">template</a>&nbsp;&nbsp;
      <a href="#M000294">uses_property</a>&nbsp;&nbsp;
      <a href="#M000287">with_renderer_for</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000282" class="method-detail">
        <a name="M000282"></a>

        <div class="method-heading">
          <a href="#M000282" class="method-signature">
          <span class="method-name">template</span><span class="method-args">(method, hash={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000282-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000282-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/template.rb, line 2</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">template</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">hash</span>={}) 
    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>

    <span class="ruby-identifier">file_code</span> = 
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:property</span>)
        <span class="ruby-node">&quot;lookup_property(#{ hash[:property].inspect })&quot;</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:file</span>)
        <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">:file</span>].<span class="ruby-identifier">inspect</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">caller_path</span> = <span class="ruby-identifier">caller</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/:\d+$/</span>, <span class="ruby-value str">&quot;&quot;</span>)
        <span class="ruby-identifier">basename</span> = <span class="ruby-identifier">caller_path</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">caller_path</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-value str">&quot;.rb&quot;</span>)]
        <span class="ruby-identifier">ext</span> = <span class="ruby-value str">'.tpl'</span>

        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^render(.*)$/</span>
          <span class="ruby-identifier">basename</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ext</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value str">'_'</span>, <span class="ruby-value str">'-'</span>)
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>
        <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">inspect</span>
      <span class="ruby-keyword kw">end</span>

    <span class="ruby-identifier">class_eval</span> <span class="ruby-node">%{
      def #{ method }
        r.template(#{ file_code })
      end
    }</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>
    <div id="section">
      <h2 class="section-title"><a name="SEC00088">Render</a></h2>
      <div class="section-comment">
        
      </div>      





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000284" class="method-detail">
        <a name="M000284"></a>

        <div class="method-heading">
          <a href="#M000284" class="method-signature">
          <span class="method-name">do_render</span><span class="method-args">(rendering_context)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Render the presenter in the given rendering context. <b>DO NOT</b>
overwrite this method, unless you know exactly what you&#8217;re doing!
</p>
<p>
Creates a new renderer object of the class returned by method <a
href="Presenter.html#M000288">renderer_class</a>, makes this the current
renderer, then invokes method <a href="Presenter.html#M000283">render</a>.
</p>
<dl>
<dt><tt>rendering_context</tt></dt><dd>An object of class <a href="RenderingContext.html">RenderingContext</a>

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000284-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000284-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 33</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_render</span>(<span class="ruby-identifier">rendering_context</span>)
    <span class="ruby-identifier">with_renderer_for</span>(<span class="ruby-identifier">rendering_context</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-identifier">render</span>() <span class="ruby-keyword kw">end</span> 
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000283" class="method-detail">
        <a name="M000283"></a>

        <div class="method-heading">
          <a href="#M000283" class="method-signature">
          <span class="method-name">render</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method renders the content of the presenter.
</p>
<p>
<b>OVERWRITE</b> this method in your own presenter classes to implement the
view. By default this method does nothing!
</p>
<p>
Use the current renderer as returned by <a
href="Presenter.html#M000285">renderer</a> or it&#8217;s short-cut <a
href="Presenter.html#M000286">r</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000283-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000283-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 20</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000286" class="method-detail">
        <a name="M000286"></a>

        <div class="method-heading">
          <a href="#M000286" class="method-signature">
          <span class="method-name">r</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Short cut for <a href="Presenter.html#M000285">renderer</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000286-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000286-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 43</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">r</span>() <span class="ruby-ivar">@renderer</span> <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000285" class="method-detail">
        <a name="M000285"></a>

        <div class="method-heading">
          <a href="#M000285" class="method-signature">
          <span class="method-name">renderer</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the current renderer object for use by the render methods.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000285-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000285-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 40</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">renderer</span>() <span class="ruby-ivar">@renderer</span> <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000288" class="method-detail">
        <a name="M000288"></a>

        <div class="method-heading">
          <a href="#M000288" class="method-signature">
          <span class="method-name">renderer_class</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the class used as renderer for this presenter. Overwrite this
method if you want to use a different renderer.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000288-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000288-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 66</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">renderer_class</span>
    <span class="ruby-constant">Wee</span><span class="ruby-operator">::</span><span class="ruby-constant">DefaultRenderer</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000287" class="method-detail">
        <a name="M000287"></a>

        <div class="method-heading">
          <a href="#M000287" class="method-signature">
          <span class="method-name">with_renderer_for</span><span class="method-args">(rendering_context) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a new renderer object of the class returned by method <a
href="Presenter.html#M000288">renderer_class</a>, then makes this the
current renderer for the time the block it yields to executes. Finally, it
restores the current renderer to the former one and closes the newly
created renderer.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000287-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000287-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 50</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_renderer_for</span>(<span class="ruby-identifier">rendering_context</span>) 
    <span class="ruby-identifier">renderer</span> = <span class="ruby-identifier">renderer_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rendering_context</span>)
    <span class="ruby-identifier">renderer</span>.<span class="ruby-identifier">current_component</span> = <span class="ruby-keyword kw">self</span>
    <span class="ruby-identifier">old_renderer</span> = <span class="ruby-ivar">@renderer</span> 
    <span class="ruby-keyword kw">begin</span>
      <span class="ruby-ivar">@renderer</span> = <span class="ruby-identifier">renderer</span>
      <span class="ruby-keyword kw">yield</span>
    <span class="ruby-keyword kw">ensure</span>
      <span class="ruby-ivar">@renderer</span> = <span class="ruby-identifier">old_renderer</span>
      <span class="ruby-identifier">renderer</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment cmt"># write outstanding brushes to the document</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>
    <div id="section">
      <h2 class="section-title"><a name="SEC00089">Callback</a></h2>
      <div class="section-comment">
        
      </div>      





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000289" class="method-detail">
        <a name="M000289"></a>

        <div class="method-heading">
          <a href="#M000289" class="method-signature">
          <span class="method-name">process_callbacks</span><span class="method-args">(callback_stream) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Process all callbacks specified for this presenter.
</p>
<p>
At first, this method invokes all input callbacks of this presenter, then
it calls the block if one was given (used by subclasses). Finally, the
action callback is invoked (there&#8217;s only one per request).
</p>
<p>
NOTE: Input callbacks should never call other components!
</p>
<dl>
<dt><tt>callback_stream</tt></dt><dd>An object of class <a href="CallbackStream.html">CallbackStream</a>

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000289-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000289-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 87</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_callbacks</span>(<span class="ruby-identifier">callback_stream</span>) <span class="ruby-comment cmt"># :yields:</span>
    <span class="ruby-comment cmt"># invoke input callbacks</span>
    <span class="ruby-identifier">callback_stream</span>.<span class="ruby-identifier">with_callbacks_for</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">:input</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">callback</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>)
    }

    <span class="ruby-comment cmt"># enable subclasses to add behaviour, e.g. a Component class will invoke</span>
    <span class="ruby-comment cmt"># process_callbacks_chain for each child in the block.</span>
    <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>

    <span class="ruby-comment cmt"># invoke action callback. only the first action callback is invoked.</span>
    <span class="ruby-identifier">callback_stream</span>.<span class="ruby-identifier">with_callbacks_for</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">:action</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">callback</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>
      <span class="ruby-identifier">throw</span> <span class="ruby-identifier">:wee_back_to_session</span>
    }
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>
    <div id="section">
      <h2 class="section-title"><a name="SEC00090">Backtrack</a></h2>
      <div class="section-comment">
        
      </div>      





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000290" class="method-detail">
        <a name="M000290"></a>

        <div class="method-heading">
          <a href="#M000290" class="method-signature">
          <span class="method-name">backtrack_state</span><span class="method-args">(snapshot)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Dummy implementation. See <a
href="Component.html#M000263">Component#backtrack_state</a> for more
information.
</p>
<dl>
<dt><tt>snapshot</tt></dt><dd>An object of class <a href="Snapshot.html">Snapshot</a>

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000290-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000290-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 115</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">backtrack_state</span>(<span class="ruby-identifier">snapshot</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>
    <div id="section">
      <h2 class="section-title"><a name="SEC00091">Session</a></h2>
      <div class="section-comment">
        
      </div>      





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000291" class="method-detail">
        <a name="M000291"></a>

        <div class="method-heading">
          <a href="#M000291" class="method-signature">
          <span class="method-name">session</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the current session. A presenter (or component) has always an
associated session. The returned object is of class <a
href="Session.html">Wee::Session</a> or a subclass thereof.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000291-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000291-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 128</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">session</span>
    <span class="ruby-constant">Wee</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">current</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>
    <div id="section">
      <h2 class="section-title"><a name="SEC00092">Properties</a></h2>
      <div class="section-comment">
        
      </div>      





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">properties</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000294" class="method-detail">
        <a name="M000294"></a>

        <div class="method-heading">
          <a href="#M000294" class="method-signature">
          <span class="method-name">uses_property</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is currently only used for describing which properties are required by
the underlying component.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000294-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000294-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 197</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">uses_property</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000292" class="method-detail">
        <a name="M000292"></a>

        <div class="method-heading">
          <a href="#M000292" class="method-signature">
          <span class="method-name">get_property</span><span class="method-args">(prop)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an &quot;owned&quot; property.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000292-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000292-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 140</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@properties</span>
      <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">prop</span>]
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000293" class="method-detail">
        <a name="M000293"></a>

        <div class="method-heading">
          <a href="#M000293" class="method-signature">
          <span class="method-name">lookup_property</span><span class="method-args">(prop)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Tries to lookup a property from different places. <tt>nil</tt> as property
value is not allowed!
</p>
<p>
Search order:
</p>
<ol>
<li>self.get_property(prop)

</li>
<li>session.get_property(prop, self.class)

</li>
<li>application.get_property(prop, self.class)

</li>
<li>session.get_property(prop, nil)

</li>
<li>application.get_property(prop, nil)

</li>
<li>@@properties[prop]

</li>
</ol>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000293-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000293-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/core/presenter.rb, line 166</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lookup_property</span>(<span class="ruby-identifier">prop</span>)
    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>

    <span class="ruby-identifier">sess</span> = <span class="ruby-identifier">session</span>()
    <span class="ruby-identifier">app</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">application</span>
    <span class="ruby-identifier">klass</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>

    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>, <span class="ruby-identifier">klass</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>

    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>, <span class="ruby-identifier">klass</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>

    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">sess</span>.<span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>, <span class="ruby-keyword kw">nil</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>

    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">get_property</span>(<span class="ruby-identifier">prop</span>, <span class="ruby-keyword kw">nil</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>

    <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-ivar">@@properties</span>)
      <span class="ruby-identifier">val</span> = <span class="ruby-ivar">@@properties</span>[<span class="ruby-identifier">prop</span>]
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>