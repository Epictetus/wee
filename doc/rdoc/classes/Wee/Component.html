<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Wee::Component</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Wee::Component</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/wee/conversation_rb.html">
                lib/wee/conversation.rb
                </a>
        <br />
                <a href="../../files/lib/wee/component_rb.html">
                lib/wee/component.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The base class of all components. You should at least overwrite method <a
href="Component.html#M000240">render</a> in your own subclasses.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000242">children</a>&nbsp;&nbsp;
      <a href="#M000236">choose_from</a>&nbsp;&nbsp;
      <a href="#M000234">confirm</a>&nbsp;&nbsp;
      <a href="#M000233">display</a>&nbsp;&nbsp;
      <a href="#M000235">inform</a>&nbsp;&nbsp;
      <a href="#M000237">instanciate</a>&nbsp;&nbsp;
      <a href="#M000239">new</a>&nbsp;&nbsp;
      <a href="#M000243">process_callbacks</a>&nbsp;&nbsp;
      <a href="#M000240">render</a>&nbsp;&nbsp;
      <a href="#M000238">root?</a>&nbsp;&nbsp;
      <a href="#M000241">state</a>&nbsp;&nbsp;
      <a href="#M000244">state_decoration</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="DecorationMixin.html">Wee::DecorationMixin</a></span>
        <span class="include-name"><a href="CallAnswerMixin.html">Wee::CallAnswerMixin</a></span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">NO_CHILDREN</td>
          <td>=</td>
          <td class="context-item-value">[].freeze</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000237" class="method-detail">
        <a name="M000237"></a>

        <div class="method-heading">
          <a href="#M000237" class="method-signature">
          <span class="method-name">instanciate</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructs a <a href="Component.html#M000239">new</a> instance of the
component and adds neccessary decorations.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000237-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000237-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 17</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instanciate</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
      <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
      <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:root?</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">root?</span>
        <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">add_decoration</span> <span class="ruby-constant">Wee</span><span class="ruby-operator">::</span><span class="ruby-constant">PageDecoration</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">add_decoration</span> <span class="ruby-constant">Wee</span><span class="ruby-operator">::</span><span class="ruby-constant">FormDecoration</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">obj</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000239" class="method-detail">
        <a name="M000239"></a>

        <div class="method-heading">
          <a href="#M000239" class="method-signature">
          <span class="method-name">new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initializes a newly created component.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000239-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000239-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 37</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000242" class="method-detail">
        <a name="M000242"></a>

        <div class="method-heading">
          <a href="#M000242" class="method-signature">
          <span class="method-name">children</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return all child components.
</p>
<p>
<b>OVERWRITE</b> this method and return all child components collected in
an array.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000242-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000242-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 90</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">children</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-constant">NO_CHILDREN</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000236" class="method-detail">
        <a name="M000236"></a>

        <div class="method-heading">
          <a href="#M000236" class="method-signature">
          <span class="method-name">choose_from</span><span class="method-args">(items, caption=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000236-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000236-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/conversation.rb, line 35</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">choose_from</span>(<span class="ruby-identifier">items</span>, <span class="ruby-identifier">caption</span>=<span class="ruby-keyword kw">nil</span>)
      <span class="ruby-identifier">display</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">h3</span> <span class="ruby-identifier">caption</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">caption</span>
        <span class="ruby-identifier">selection</span> = <span class="ruby-keyword kw">nil</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">items</span>).<span class="ruby-identifier">callback</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">selection</span> = <span class="ruby-identifier">s</span> }
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">break</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">submit_button</span>.<span class="ruby-identifier">callback</span> { <span class="ruby-identifier">answer</span> <span class="ruby-identifier">selection</span> }.<span class="ruby-identifier">value</span>(<span class="ruby-value str">&quot;Ok&quot;</span>); <span class="ruby-identifier">r</span>.<span class="ruby-identifier">space</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">submit_button</span>.<span class="ruby-identifier">callback</span> { <span class="ruby-identifier">answer</span> <span class="ruby-keyword kw">nil</span> }.<span class="ruby-identifier">value</span>(<span class="ruby-value str">&quot;Cancel&quot;</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000234" class="method-detail">
        <a name="M000234"></a>

        <div class="method-heading">
          <a href="#M000234" class="method-signature">
          <span class="method-name">confirm</span><span class="method-args">(question)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000234-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000234-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/conversation.rb, line 20</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">confirm</span>(<span class="ruby-identifier">question</span>)
      <span class="ruby-identifier">display</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">h3</span> <span class="ruby-identifier">question</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">submit_button</span>.<span class="ruby-identifier">callback</span> { <span class="ruby-identifier">answer</span> <span class="ruby-keyword kw">true</span> }.<span class="ruby-identifier">value</span>(<span class="ruby-value str">&quot;Yes&quot;</span>); <span class="ruby-identifier">r</span>.<span class="ruby-identifier">space</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">submit_button</span>.<span class="ruby-identifier">callback</span> { <span class="ruby-identifier">answer</span> <span class="ruby-keyword kw">false</span> }.<span class="ruby-identifier">value</span>(<span class="ruby-value str">&quot;No&quot;</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000233" class="method-detail">
        <a name="M000233"></a>

        <div class="method-heading">
          <a href="#M000233" class="method-signature">
          <span class="method-name">display</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000233-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000233-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/conversation.rb, line 16</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">display</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
      <span class="ruby-identifier">callcc</span> <span class="ruby-constant">BlockComponent</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) 
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000235" class="method-detail">
        <a name="M000235"></a>

        <div class="method-heading">
          <a href="#M000235" class="method-signature">
          <span class="method-name">inform</span><span class="method-args">(message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000235-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000235-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/conversation.rb, line 28</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inform</span>(<span class="ruby-identifier">message</span>)
      <span class="ruby-identifier">display</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">h3</span> <span class="ruby-identifier">message</span>  
        <span class="ruby-identifier">r</span>.<span class="ruby-identifier">submit_button</span>.<span class="ruby-identifier">callback</span> { <span class="ruby-identifier">answer</span> }.<span class="ruby-identifier">value</span>(<span class="ruby-value str">&quot;Ok&quot;</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000243" class="method-detail">
        <a name="M000243"></a>

        <div class="method-heading">
          <a href="#M000243" class="method-signature">
          <span class="method-name">process_callbacks</span><span class="method-args">(callbacks)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Process and invoke all input callbacks specified for this component and all
of it&#8216;s child components.
</p>
<p>
Returns the action callback to be invoked.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000243-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000243-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 100</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_callbacks</span>(<span class="ruby-identifier">callbacks</span>)
      <span class="ruby-identifier">callbacks</span>.<span class="ruby-identifier">input_callbacks</span>.<span class="ruby-identifier">each_triggered_call_with_value</span>(<span class="ruby-keyword kw">self</span>)

      <span class="ruby-identifier">action_callback</span> = <span class="ruby-keyword kw">nil</span>

      <span class="ruby-comment cmt"># process callbacks of all children</span>
      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">child</span> <span class="ruby-keyword kw">in</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">children</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">act</span> = <span class="ruby-identifier">child</span>.<span class="ruby-identifier">decoration</span>.<span class="ruby-identifier">process_callbacks</span>(<span class="ruby-identifier">callbacks</span>)
          <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Duplicate action callback&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">action_callback</span>
          <span class="ruby-identifier">action_callback</span> = <span class="ruby-identifier">act</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">act</span> = <span class="ruby-identifier">callbacks</span>.<span class="ruby-identifier">action_callbacks</span>.<span class="ruby-identifier">first_triggered</span>(<span class="ruby-keyword kw">self</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Duplicate action callback&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">action_callback</span>
        <span class="ruby-identifier">action_callback</span> = <span class="ruby-identifier">act</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">action_callback</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000240" class="method-detail">
        <a name="M000240"></a>

        <div class="method-heading">
          <a href="#M000240" class="method-signature">
          <span class="method-name">render</span><span class="method-args">(r)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method renders the content of the component.
</p>
<p>
<b>OVERWRITE</b> this method in your own component classes to implement the
view. By default this method does nothing!
</p>
<dl>
<dt><tt>r</tt></dt><dd>An instance of class <tt>renderer_class()</tt>

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000240-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000240-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 49</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000238" class="method-detail">
        <a name="M000238"></a>

        <div class="method-heading">
          <a href="#M000238" class="method-signature">
          <span class="method-name">root?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Is this a root component, which doesn&#8216;t need to be wrapped with a <a
href="PageDecoration.html">PageDecoration</a> and <a
href="FormDecoration.html">FormDecoration</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000238-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000238-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 30</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">root?</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000241" class="method-detail">
        <a name="M000241"></a>

        <div class="method-heading">
          <a href="#M000241" class="method-signature">
          <span class="method-name">state</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Take snapshots of objects that should correctly be backtracked.
</p>
<p>
Backtracking means that you can go back in time of the components&#8217; <a
href="Component.html#M000241">state</a>. Therefore it is neccessary to take
snapshots of those objects that want to participate in backtracking. Taking
snapshots of the whole component tree would be too expensive and
unflexible. Note that methods <em>take_snapshot</em> and
<em>restore_snapshot</em> are called for those objects to take the snapshot
(they behave like <em>marshal_dump</em> and <em>marshal_load</em>).
Overwrite them if you want to define special behaviour.
</p>
<p>
By default only the decoration chain is backtracked. This is required to
correctly backtrack called components. To disable backtracking of the
decorations, change method <a
href="Component.html#M000244">Component#state_decoration</a> to a
no-operation:
</p>
<pre>
  def state_decoration(s)
    # nothing here
  end
</pre>
<dl>
<dt><tt>s</tt></dt><dd>An object of class <a href="State.html">State</a>

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000241-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000241-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 76</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">state</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-identifier">state_decoration</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">child</span> <span class="ruby-keyword kw">in</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">children</span>
        <span class="ruby-identifier">child</span>.<span class="ruby-identifier">decoration</span>.<span class="ruby-identifier">state</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000244" class="method-detail">
        <a name="M000244"></a>

        <div class="method-heading">
          <a href="#M000244" class="method-signature">
          <span class="method-name">state_decoration</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000244-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000244-source">
<pre>
<span class="ruby-comment cmt"># File lib/wee/component.rb, line 123</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">state_decoration</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-identifier">s</span>.<span class="ruby-identifier">add_ivar</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">:@decoration</span>, <span class="ruby-ivar">@decoration</span>)
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>